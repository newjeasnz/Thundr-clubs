{% load static %}
<div class="bg-[#ffffff] rounded-xl shadow-md overflow-hidden relative hover:shadow-xl transition duration-300 flex flex-col h-full">

  <!-- Edit & Delete Icons -->
  {% if user.is_authenticated and product.user == user %}
  <div class="absolute top-3 right-3 flex space-x-2">
    <!-- Edit Button -->
    <a href="{% url 'main:edit_product' product.id %}"
       class="bg-[#efa041]/80 backdrop-blur-md p-2 rounded-full hover:bg-[#efa041]/90 transition">
      <img src="{% static 'icons/pencil.png' %}" alt="Edit" class="w-4 h-4 invert brightness-0">
    </a>

    <!-- Delete Button (Trigger Modal) -->
    <button 
      type="button"
      onclick="document.getElementById('deleteDialog-{{ product.id }}').showModal()"
      class="bg-red-600/80 backdrop-blur-md p-2 rounded-full hover:bg-red-600/90 transition">
      <img src="{% static 'icons/trash-2.png' %}" alt="Delete" class="w-4 h-4 invert brightness-0">
    </button>
  </div>

    <!-- Modal Konfirmasi Delete -->
    <dialog id="deleteDialog-{{ product.id }}" class="rounded-lg p-6 max-w-sm w-full backdrop:bg-black/50">
    <!-- Header dengan Icon -->
    <div class="flex items-center gap-3 mb-3">
        <div class="w-10 h-10 flex items-center justify-center bg-red-100 rounded-full">
        <img src="{% static 'icons/octagon-alert.png' %}" alt="Alert" class="w-6 h-6">
        </div>
        <h3 class="text-lg font-bold text-gray-900">Hapus Produk?</h3>
    </div>

    <!-- Isi Pesan -->
    <p class="text-gray-700 mb-4">
        Apakah kamu yakin ingin menghapus <strong>{{ product.name }}</strong>?  
        Setelah dihapus, produk tidak dapat dipulihkan.
    </p>

    <!-- Tombol Aksi -->
    <div class="flex justify-end gap-3">
        <button 
        type="button"
        onclick="document.getElementById('deleteDialog-{{ product.id }}').close()"
        class="px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300 transition">
        Batal
        </button>
        <a href="{% url 'main:delete_product' product.id %}" 
        class="px-4 py-2 rounded-md bg-red-600 text-white hover:bg-red-700 transition">
        Hapus
        </a>
    </div>
    </dialog>
    {% endif %}

  <!-- Thumbnail -->
  <a href="{% url 'main:show_detail_product' product.id %}">
    {% if product.thumbnail %}
      <img src="{{ product.thumbnail }}" alt="{{ product.name }}" class="w-full h-56 object-cover">
    {% else %}
      <div class="w-full h-56 bg-[#4b2b21] flex items-center justify-center text-[#fad29a]/60">
        No Image
      </div>
    {% endif %}
  </a>

  <!-- Content -->
  <div class="flex flex-col flex-1 px-5 pt-4 pb-5">

    <!-- Nama Produk -->
    <a href="{% url 'main:show_detail_product' product.id %}">
      <h5 class="text-lg font-semibold tracking-tight text-[#433f3f] hover:text-[#2a1f20] transition line-clamp-2 min-h-[3.5rem]">
        {{ product.name }}
      </h5>
    </a>

    <!-- Deskripsi Produk -->
    <a href="{% url 'main:show_detail_product' product.id %}">
      <p class="text-sm text-[#2a1f20] hover:text-[#2a1f20] transition line-clamp-2 min-h-[3.5rem]">
        {{ product.description|truncatewords:15 }}
      </p>
    </a>

    <!-- Spacer -->
    <div class="flex-grow"></div>

    <!-- Harga + Tombol -->
    <div class="flex items-center justify-between mt-4">
      <span class="text-xl font-bold text-[#433f3f] whitespace-nowrap">
        Rp{{ product.price }}
      </span>
      <a href="{% url 'main:show_detail_product' product.id %}" 
         class="bg-[#2a1f20] hover:bg-[#433f3f] text-[#ffffff] font-semibold rounded-lg text-sm px-5 py-2.5 transition">
        See More
      </a>
    </div>
  </div>
</div>